function max_eigs  = dfdbk_std_split_steadystate(w,k,q,diff,tr1_e,tr2_e,U1_e,U2_e,I_step)
% What about if the steady state for Ie=0 is not zero??????????

third =   tr1_e*U1_e*tr2_e*U2_e;
second =  (tr1_e*U1_e+tr2_e*U2_e)-(1-q-diff-(k*w)./(1+k*w)*q)*w*tr2_e*U2_e...
    -(q+diff-(k*w)./(1+k*w)*(1-q))*w*tr1_e*U1_e-tr1_e*U1_e*tr2_e*U2_e*I_step;
first = 1-(1-q-diff-(k*w)./(1+k*w)*q)*w-(q+diff-(k*w)./(1+k*w)*(1-q))*w...
    -(tr1_e*U1_e+tr2_e*U2_e)*I_step;
zeroeth = -I_step;
Re_coeffs = [third,second,first,zeroeth];
roots(Re_coeffs)
Re_ss = max(roots(Re_coeffs));

x1_ss = 1/(1+tr1_e*U1_e*Re_ss);
x2_ss = 1/(1+tr2_e*U2_e*Re_ss);


te  = 0.02;
ti  = 0.01;
tee_a = 0.005;
tee_n = 0.1;
tie_a = 0.005;
tie_n = 0.1;
tei = 0.01;
tii = 0.01;



A_high = [-1/te,0,((1-q)-diff)*w/te,(q+diff)*w/te,0,0,-k*w/te,0,0,0;...
    0,-1/ti,0,0,(1-q)*w/ti,q*w/ti,0,-k*w/ti,0,0;...
    x1_ss/tee_a,0,-1/tee_a,0,0,0,0,0,Re_ss/tee_a,0;...
    x2_ss/tee_n,0,0,-1/tee_n,0,0,0,0,0,Re_ss/tee_n;...
    x2_ss/tie_a,0,0,0,-1/tie_a,0,0,0,0,Re_ss/tie_a;...
    x1_ss/tie_n,0,0,0,0,-1/tie_n,0,0,Re_ss/tie_n,0;...
    0,1/tei,0,0,0,0,-1/tei,0,0,0;...
    0,1/tii,0,0,0,0,0,-1/tii,0,0;...
    -U1_e*x1_ss,0,0,0,0,0,0,0,-1/tr1_e-U1_e*Re_ss,0;...
    -U2_e*x2_ss,0,0,0,0,0,0,0,0,-1/tr2_e-U2_e*Re_ss];


A_low = [-1/te,0,((1-q)-diff)*w/te,(q+diff)*w/te,0,0,-k*w/te,0,0,0;...
    0,-1/ti,0,0,(1-q)*w/ti,q*w/ti,0,-k*w/ti,0,0;...
    1/tee_a,0,-1/tee_a,0,0,0,0,0,0,0;...
    1/tee_n,0,0,-1/tee_n,0,0,0,0,0,0;...
    1/tie_a,0,0,0,-1/tie_a,0,0,0,0,0;...
    1/tie_n,0,0,0,0,-1/tie_n,0,0,0,0;...
    0,1/tei,0,0,0,0,-1/tei,0,0,0;...
    0,1/tii,0,0,0,0,0,-1/tii,0,0;...
    -U1_e,0,0,0,0,0,0,0,-1/tr1_e,0;...
    -U2_e,0,0,0,0,0,0,0,0,-1/tr2_e];


A_lin_high = [-1/te,0,((1-q)-diff)*x1_ss*w/te,(q+diff)*x2_ss*w/te,0,0,-k*w/te,0;...
    0,-1/ti,0,0,(1-q)*x2_ss*w/ti,q*x1_ss*w/ti,0,-k*w/ti;...
    1/tee_a,0,-1/tee_a,0,0,0,0,0;...
    1/tee_n,0,0,-1/tee_n,0,0,0,0;...
    1/tie_a,0,0,0,-1/tie_a,0,0,0;...
    1/tie_n,0,0,0,0,-1/tie_n,0,0;...
    0,1/tei,0,0,0,0,-1/tei,0;...
    0,1/tii,0,0,0,0,0,-1/tii];

A_lin_low = [-1/te,0,((1-q)-diff)*w/te,(q+diff)*w/te,0,0,-k*w/te,0;...
    0,-1/ti,0,0,(1-q)*w/ti,q*w/ti,0,-k*w/ti;...
    1/tee_a,0,-1/tee_a,0,0,0,0,0;...
    1/tee_n,0,0,-1/tee_n,0,0,0,0;...
    1/tie_a,0,0,0,-1/tie_a,0,0,0;...
    1/tie_n,0,0,0,0,-1/tie_n,0,0;...
    0,1/tei,0,0,0,0,-1/tei,0;...
    0,1/tii,0,0,0,0,0,-1/tii];

eig(A_high)
nonlin_stab_high = max(real(eig(A_high)));
nonlin_stab_low = max(real(eig(A_low)));
lin_stab_high = max(real(eig(A_lin_high)));
lin_stab_low = max(real(eig(A_lin_low)));

max_eigs = [nonlin_stab_high,nonlin_stab_low,lin_stab_high,lin_stab_low];
        
end



























